// Generated by ReScript, PLEASE EDIT WITH CARE

import * as React from "react";
import * as Loading from "./Loading.mjs";
import * as Util from "@1r21/util";
import * as ApiH5 from "@1r21/api-h5";

function Detail(Props) {
  var id = Props.id;
  var match = React.useState(function () {
        return false;
      });
  var setLoading = match[1];
  var match$1 = React.useState(function () {
        return {
                id: "",
                title: "",
                cover: "",
                date: ""
              };
      });
  var setArticle = match$1[1];
  var article = match$1[0];
  var match$2 = React.useState(function () {
        return [];
      });
  var setTexts = match$2[1];
  React.useEffect((function () {
          setLoading(function (_p) {
                return true;
              });
          ApiH5.getNewsById(id).then(function (ret) {
                setArticle(function (_p) {
                      return ret;
                    });
                var v = ret.transcript;
                if (v !== undefined) {
                  var formatTexts = Util.parseText(v);
                  setTexts(function (_p) {
                        return formatTexts;
                      });
                  setLoading(function (_p) {
                        return false;
                      });
                }
                return Promise.resolve(undefined);
              });
        }), [id]);
  var textContent = match$2[0].map(function (txt) {
        var style = {
          color: txt.style.color,
          fontWeight: txt.style.fontWeight
        };
        return React.createElement("p", {
                    key: txt.idx.toString(),
                    className: "my-2",
                    style: style
                  }, txt.value);
      });
  if (match[0]) {
    return React.createElement(Loading.make, {
                delay: 300
              });
  }
  var href = article.source;
  var src = article.src;
  return React.createElement("div", {
              className: "w-3/5 mx-auto pb-[100px]"
            }, React.createElement("div", undefined, textContent, React.createElement("p", {
                      className: "text-right"
                    }, "from: ", href !== undefined ? React.createElement("a", {
                            className: "text-blue-500 italic underline",
                            href: href,
                            rel: "noreferrer",
                            target: "_blank"
                          }, "pbs") : null)), src !== undefined ? React.createElement("audio", {
                    className: "fixed bottom-2 w-3/5 outline-none",
                    controls: true,
                    src: src
                  }) : null);
}

var make = Detail;

export {
  make ,
}
/* react Not a pure module */
